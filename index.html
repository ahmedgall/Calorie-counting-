<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calzy OS | Ù…Ø¯Ø±Ø¨Ùƒ Ø§Ù„Ø°ÙƒÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --p: #8b5cf6; --s: #10b981; --bg: #05070a; --card: #111827; --text: #f9fafb; --d: #ef4444; --w: #3b82f6;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background: var(--bg); color: var(--text); min-height: 100vh; padding-bottom: 90px; }
        .container { max-width: 450px; margin: 0 auto; padding: 20px; }

        .setup-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 5000; padding: 30px; display: flex; flex-direction: column; justify-content: center; }
        
        /* Progress Circle */
        .main-display { position: relative; width: 220px; height: 220px; margin: 0 auto 30px; display: flex; justify-content: center; align-items: center; }
        svg { transform: rotate(-90deg); width: 220px; height: 220px; }
        circle { fill: none; stroke-width: 15; stroke-linecap: round; }
        .track { stroke: rgba(255,255,255,0.05); }
        .progress { stroke: var(--p); stroke-dasharray: 628; stroke-dashoffset: 628; transition: 1s cubic-bezier(0.4, 0, 0.2, 1); filter: drop-shadow(0 0 8px var(--p)); }
        .inner-content { position: absolute; text-align: center; }
        .inner-content h2 { font-size: 40px; font-weight: 900; line-height: 1; }

        .glass-card { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: 24px; padding: 20px; margin-bottom: 15px; }
        .macro-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .macro-box { text-align: center; background: rgba(255,255,255,0.02); padding: 12px 5px; border-radius: 18px; border: 1px solid rgba(255,255,255,0.05); }
        .macro-box b { font-size: 14px; color: var(--s); display: block; }
        .macro-box small { color: #94a3b8; font-size: 11px; }

        /* Water Section Styles */
        .water-card { background: linear-gradient(145deg, #111827, #0f172a); border: 1px solid rgba(59, 130, 246, 0.2); }
        .water-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .water-bar-bg { width: 100%; height: 10px; background: rgba(255,255,255,0.05); border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .water-bar-fill { height: 100%; background: var(--w); width: 0%; transition: 0.5s ease; box-shadow: 0 0 10px var(--w); }
        .water-btn { background: var(--w); border: none; color: white; padding: 8px 15px; border-radius: 12px; font-weight: 900; cursor: pointer; transition: 0.3s; }
        .water-btn:active { transform: scale(0.9); }

        input, select { width: 100%; padding: 15px; background: #1f2937; border: 1px solid #374151; border-radius: 14px; color: white; margin-bottom: 12px; outline: none; }
        .btn-p { width: 100%; padding: 16px; border-radius: 14px; border: none; font-weight: 900; background: var(--p); color: white; cursor: pointer; }

        .log-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .del-btn { color: var(--d); cursor: pointer; font-size: 18px; }

        nav { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(11, 15, 26, 0.95); backdrop-filter: blur(10px); display: flex; justify-content: space-around; padding: 20px; border-top: 1px solid #1f2937; z-index: 1000; }
        .nav-item { color: #4b5563; font-size: 26px; cursor: pointer; }
        .nav-item.active { color: var(--p); }

        .hidden { display: none; }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; display: none; align-items: flex-end; }
        .modal-inner { background: var(--card); width: 100%; border-radius: 30px 30px 0 0; padding: 30px; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .tool-card { display: flex; align-items: center; gap: 15px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 18px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05); cursor: pointer; text-decoration: none; color: inherit; }
        .tool-icon { font-size: 24px; background: var(--card); padding: 10px; border-radius: 12px; }
    </style>
</head>
<body>

<div id="setupLayer" class="setup-overlay hidden">
    <h1 style="margin-bottom: 10px; font-weight: 900;">CALZY OS <span style="color:var(--p)">2026</span></h1>
    <p style="margin-bottom: 25px; color: #94a3b8;">Ø§Ø¶Ø¨Ø· Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¬Ø³Ù…Ùƒ..</p>
    <input type="text" id="setupName" placeholder="Ø§Ù„Ø§Ø³Ù…">
    <select id="setupGender"><option value="male">Ø°ÙƒØ±</option><option value="female">Ø£Ù†Ø«Ù‰</option></select>
    <div style="display: flex; gap: 10px;">
        <input type="number" id="setupW" placeholder="Ø§Ù„ÙˆØ²Ù†">
        <input type="number" id="setupH" placeholder="Ø§Ù„Ø·ÙˆÙ„">
    </div>
    <input type="number" id="setupA" placeholder="Ø§Ù„Ø¹Ù…Ø±">
    <select id="setupGoal">
        <option value="cut">ØªÙ†Ø´ÙŠÙ ğŸ”¥</option>
        <option value="maintain" selected>Ø«Ø¨Ø§Øª âš–ï¸</option>
        <option value="bulk">ØªØ¶Ø®ÙŠÙ… ğŸ’ª</option>
    </select>
    <button class="btn-p" onclick="finishSetup()">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª âœ…</button>
</div>

<div class="container" id="mainApp">
    <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
        <div>
            <h2 id="greetUser">Ù…Ø±Ø­Ø¨Ø§Ù‹</h2>
            <div id="statusTag" style="display:inline-block; margin-top:5px; padding:2px 10px; background:rgba(139, 92, 246, 0.15); color:var(--p); border-radius:8px; font-size:12px; font-weight:900;"></div>
        </div>
        <div onclick="resetSystem()" style="cursor:pointer; opacity: 0.5; font-size: 13px;">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
    </header>

    <div id="home-page">
        <div class="main-display">
            <svg><circle class="track" cx="110" cy="110" r="100"></circle><circle id="progCircle" class="progress" cx="110" cy="110" r="100"></circle></svg>
            <div class="inner-content"><p style="color:#94a3b8; font-size:14px">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</p><h2 id="calRem">0</h2><small id="calTotal" style="font-size:10px; color:#6b7280"></small></div>
        </div>

        <div class="macro-row glass-card">
            <div class="macro-box"><small>Ø¨Ø±ÙˆØªÙŠÙ†</small><b id="pVal">0/0</b></div>
            <div class="macro-box"><small>ÙƒØ§Ø±Ø¨</small><b id="cbVal">0/0</b></div>
            <div class="macro-box"><small>Ø¯Ù‡ÙˆÙ†</small><b id="fVal">0/0</b></div>
        </div>

        <div class="glass-card water-card">
            <div class="water-header">
                <div>
                    <span style="font-size: 18px;">ğŸ’§ Ø§Ù„Ù…Ø§Ø¡</span>
                    <div id="waterText" style="font-size: 12px; color: #94a3b8;">Ø´Ø±Ø¨Øª: 0 / 3 Ù„ØªØ±</div>
                </div>
                <button class="water-btn" onclick="addWater(0.25)">+ 250ml</button>
            </div>
            <div class="water-bar-bg">
                <div id="waterBar" class="water-bar-fill"></div>
            </div>
            <p id="waterGoalMsg" style="font-size: 10px; color: var(--s); text-align: center; display: none;">Ø£Ø­Ø³Ù†Øª! ÙˆØµÙ„Øª Ù„Ù‡Ø¯ÙÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ ğŸš€</p>
        </div>

        <div class="glass-card">
            <h4 style="margin-bottom: 15px;">ÙˆØ¬Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ… ğŸ“</h4>
            <div id="logsList"></div>
        </div>
    </div>

    <div id="services-page" class="hidden">
        <h3 style="margin-bottom: 20px;">Ø§Ù„Ø®Ø¯Ù…Ø§Øª ğŸ› ï¸</h3>
        <div class="tool-card" onclick="alert('Ø§Ø­ØªÙŠØ§Ø¬ Ø§Ù„Ù…Ø§Ø¡: ' + (userDB.userW * 0.04).toFixed(1) + ' Ù„ØªØ±/ÙŠÙˆÙ… Ù„Ù†Ù…Ø· Ø­ÙŠØ§Ø© Ø±ÙŠØ§Ø¶ÙŠ')">
            <div class="tool-icon">ğŸ’§</div>
            <div><b>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</b><br><small style="color:#94a3b8">Ø£ÙƒØ«Ø± Ø¯Ù‚Ø© Ù„Ù„Ø±ÙŠØ§Ø¶ÙŠÙŠÙ†</small></div>
        </div>
       
        <div class="tool-card" onclick="alert('Ù…Ø§ÙƒØ±ÙˆØ²Ùƒ Ù…Ø­Ø³ÙˆØ¨ Ø¨Ù†Ø³Ø¨Ø© Ø¨Ø±ÙˆØªÙŠÙ† Ø¹Ø§Ù„ÙŠØ© (2.2g Ù„ÙƒÙ„ ÙƒÙŠÙ„Ùˆ) Ù„Ø¯Ø¹Ù… Ø§Ù„Ø¹Ø¶Ù„Ø§Øª')">
            <div class="tool-icon">âš¡</div>
            <div><b>Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§ÙƒØ±ÙˆØ² Ø§Ù„Ø°ÙƒÙŠ</b><br><small style="color:#94a3b8">ØªØ­Ù„ÙŠÙ„ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ØºØ°ÙŠØ§Øª</small></div>
        </div>
   
        <a href="exercises.html" class="tool-card">
            <div class="tool-icon">ğŸ’ª</div>
            <div><b>ØªÙ…Ø±ÙŠÙ†Ø§Øª</b><br><small style="color:#94a3b8">Ù†Ø¸Ø§Ù… ØªÙ…Ø±ÙŠÙ† Ù…Ø¹ØªÙ…Ø¯</small></div>
        </a>
    </div>
</div>

<div id="addModal" class="modal">
    <div class="modal-inner">
        <h3>Ø¥Ø¶Ø§ÙØ© ÙˆØ¬Ø¨Ø©</h3><br>
        <input type="text" id="inN" placeholder="Ø§Ø³Ù… Ø§Ù„ÙˆØ¬Ø¨Ø©">
        <input type="number" id="inC" placeholder="Ø§Ù„Ø³Ø¹Ø±Ø§Øª">
        <div style="display: flex; gap: 8px;">
            <input type="number" id="inP" placeholder="Ø¨Ø±ÙˆØªÙŠÙ†"><input type="number" id="inCB" placeholder="ÙƒØ§Ø±Ø¨"><input type="number" id="inF" placeholder="Ø¯Ù‡ÙˆÙ†">
        </div>
        <button class="btn-p" onclick="confirmAdd()">Ø¥Ø¶Ø§ÙØ© âœ…</button>
        <button onclick="closeAdd()" style="width:100%; background:none; border:none; color:#6b7280; margin-top:15px; cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<nav>
    <div class="nav-item active" id="navHome" onclick="showPage('home')">ğŸ </div>
    <div class="nav-item" onclick="openAdd()">â•</div>
    <div class="nav-item" id="navServices" onclick="showPage('services')">ğŸ› ï¸</div>
</nav>

<script>
    let userDB = { setup: false, current: {c:0, p:0, cb:0, f:0}, water: 0, logs: [], date: "", userW:0, userH:0, goalType: "" };

    function finishSetup() {
        const name = document.getElementById('setupName').value, 
              w = parseFloat(document.getElementById('setupW').value),
              h = parseFloat(document.getElementById('setupH').value),
              a = parseFloat(document.getElementById('setupA').value),
              g = document.getElementById('setupGender').value,
              goal = document.getElementById('setupGoal').value;

        if(!name || !w || !h) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

        let bmr = (10 * w) + (6.25 * h) - (5 * a);
        bmr = (g === 'male') ? bmr + 5 : bmr - 161;
        let tdee = bmr * 1.55; 
        if(goal === 'cut') tdee -= 500; else if(goal === 'bulk') tdee += 400;

        let proteinG = w * 2.2; 
        let fatsG = w * 0.8;
        let remainingCals = tdee - (proteinG * 4) - (fatsG * 9);
        let carbG = remainingCals / 4;

        userDB = {
            setup: true, name, goalType: goal, userW: w, userH: h,
            goals: { c: Math.round(tdee), p: Math.round(proteinG), cb: Math.round(carbG), f: Math.round(fatsG) },
            current: {c:0, p:0, cb:0, f:0}, water: 0, logs: [], date: new Date().toLocaleDateString()
        };
        saveData(); location.reload();
    }

    function checkDailyReset() {
        const today = new Date().toLocaleDateString();
        if (userDB.setup && userDB.date !== today) {
            userDB.current = {c:0, p:0, cb:0, f:0}; 
            userDB.water = 0; 
            userDB.logs = [];
            userDB.date = today; saveData();
        }
    }

    function addWater(amount) {
        userDB.water += amount;
        if(userDB.water > 5) userDB.water = 5; // Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·
        updateWaterUI();
        saveData();
    }

    function updateWaterUI() {
        const target = 3;
        const percent = (userDB.water / target) * 100;
        document.getElementById('waterBar').style.width = Math.min(percent, 100) + "%";
        document.getElementById('waterText').innerText = `Ø´Ø±Ø¨Øª: ${userDB.water.toFixed(2)} / ${target} Ù„ØªØ±`;
        
        if(userDB.water >= target) {
            document.getElementById('waterGoalMsg').style.display = "block";
            document.getElementById('waterBar').style.background = "var(--s)";
        } else {
            document.getElementById('waterGoalMsg').style.display = "none";
            document.getElementById('waterBar').style.background = "var(--w)";
        }
    }

    function showPage(p) {
        document.getElementById('home-page').classList.toggle('hidden', p !== 'home');
        document.getElementById('services-page').classList.toggle('hidden', p !== 'services');
        document.getElementById('navHome').classList.toggle('active', p === 'home');
        document.getElementById('navServices').classList.toggle('active', p === 'services');
    }

    function renderApp() {
        if(!userDB.setup) { document.getElementById('setupLayer').classList.remove('hidden'); return; }
        checkDailyReset();
        document.getElementById('greetUser').innerHTML = `Ø£Ù‡Ù„Ø§Ù‹ØŒ <span style="color:var(--p)">${userDB.name}</span>`;
        const goalsMap = { cut: "ØªÙ†Ø´ÙŠÙ ğŸ”¥", maintain: "Ø«Ø¨Ø§Øª âš–ï¸", bulk: "ØªØ¶Ø®ÙŠÙ… ğŸ’ª" };
        document.getElementById('statusTag').innerText = goalsMap[userDB.goalType];
        
        // Calories Progress
        document.getElementById('calRem').innerText = Math.max(0, userDB.goals.c - userDB.current.c);
        document.getElementById('calTotal').innerText = `Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…: ${userDB.goals.c}`;
        const offset = 628 - (Math.min(userDB.current.c / userDB.goals.c, 1) * 628);
        document.getElementById('progCircle').style.strokeDashoffset = offset;
        
        // Macros
        document.getElementById('pVal').innerText = `${Math.round(userDB.current.p)}/${userDB.goals.p}g`;
        document.getElementById('cbVal').innerText = `${Math.round(userDB.current.cb)}/${userDB.goals.cb}g`;
        document.getElementById('fVal').innerText = `${Math.round(userDB.current.f)}/${userDB.goals.f}g`;
        
        // Water
        updateWaterUI();

        // Logs
        document.getElementById('logsList').innerHTML = userDB.logs.map((item, i) => `
            <div class="log-item"><div><b>${item.n}</b><br><small>${item.c} Ø³Ø¹Ø±</small></div>
            <div class="del-btn" onclick="removeMeal(${i})">ğŸ—‘ï¸</div></div>`).reverse().join('') || '<p style="text-align:center; color:#4b5563; font-size:12px">Ø£Ø¶Ù ÙˆØ¬Ø¨ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰</p>';
    }

    function confirmAdd() {
        const n = document.getElementById('inN').value || "ÙˆØ¬Ø¨Ø©", 
              c = parseFloat(document.getElementById('inC').value) || 0,
              p = parseFloat(document.getElementById('inP').value) || 0, 
              cb = parseFloat(document.getElementById('inCB').value) || 0,
              f = parseFloat(document.getElementById('inF').value) || 0;
        userDB.current.c += c; userDB.current.p += p; userDB.current.cb += cb; userDB.current.f += f;
        userDB.logs.push({n, c, p, cb, f}); saveData(); renderApp(); closeAdd();
    }

    function removeMeal(i) {
        const item = userDB.logs[i];
        userDB.current.c -= item.c; userDB.current.p -= item.p; userDB.current.cb -= item.cb; userDB.current.f -= item.f;
        userDB.logs.splice(i, 1); saveData(); renderApp();
    }

    function openAdd() { document.getElementById('addModal').style.display = 'flex'; }
    function closeAdd() { document.getElementById('addModal').style.display = 'none'; }
    function saveData() { localStorage.setItem('calzy_vReset_Elite', JSON.stringify(userDB)); }
    function resetSystem() { if(confirm("Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·ØŸ")) { localStorage.clear(); location.reload(); } }

    window.onload = () => {
        const saved = localStorage.getItem('calzy_vReset_Elite');
        if(saved) userDB = JSON.parse(saved);
        renderApp();
        setInterval(checkDailyReset, 60000);
    };
</script>
</body>
</html>
